<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Amen Estate ‚Äì Admin & Resident Portal</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    :root{
      --bg:#0f172a;          /* slate-900 */
      --panel:#0b1226;       /* deep panel */
      --muted:#94a3b8;       /* slate-400 */
      --text:#e2e8f0;        /* slate-200 */
      --blue:#2563eb;        /* theme blue */
      --green:#10b981;       /* theme green */
      --red:#ef4444;         /* alerts/logout */
      --yellow:#f59e0b;      /* warnings */
      --card:#11193a;        /* cards */
      --stroke:#1f2a4d;      /* borders */
      --shadow: 0 10px 25px rgba(0,0,0,.35), inset 0 0 0 1px rgba(255,255,255,.03);
      --radius: 16px;
      --radius-sm: 12px;
      --radius-lg: 24px;
      --gap: 14px;
      --grad: linear-gradient(135deg, rgba(37,99,235,.9), rgba(16,185,129,.9));
      --grad-soft: linear-gradient(135deg, rgba(37,99,235,.25), rgba(16,185,129,.25));
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; font-family: Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial;
      color:var(--text); background:radial-gradient(1200px 800px at 120% -10%, rgba(16,185,129,.15), transparent),
                        radial-gradient(1000px 700px at -10% 110%, rgba(37,99,235,.18), transparent),
                        var(--bg);
    }
    .app{display:grid; grid-template-columns: 280px 1fr; min-height:100vh}
    /* Sidebar */
    .sidebar{
      background: linear-gradient(180deg, #0a1228 0%, #0b1430 100%);
      border-right:1px solid var(--stroke); padding:20px 16px; position:sticky; top:0; height:100vh; overflow:auto;
      box-shadow: var(--shadow);
    }
    .brand{display:flex; align-items:center; gap:12px; padding:8px 10px; border-radius:12px; background:var(--grad-soft); border:1px solid var(--stroke)}
    .brand-logo{width:38px; height:38px; border-radius:12px; background:var(--grad); display:grid; place-items:center; font-weight:800}
    .brand h1{font-size:16px; margin:0}
    .brand small{color:var(--muted)}

    .nav{margin-top:18px; display:flex; flex-direction:column; gap:8px}
    .nav button{
      background:transparent; border:1px solid var(--stroke); color:var(--text); padding:12px 12px; border-radius:12px; text-align:left; cursor:pointer;
      transition:.25s; display:flex; align-items:center; gap:10px; font-weight:600
    }
    .nav button.active, .nav button:hover{background:linear-gradient(135deg, rgba(37,99,235,.12), rgba(16,185,129,.12)); border-color:#2a3a6a}

    .bottom-actions{margin-top:20px; display:flex; flex-direction:column; gap:10px}
    .btn-logout{background:var(--red); color:white; border:none; padding:12px; border-radius:12px; font-weight:800; cursor:pointer; box-shadow: var(--shadow)}
    .btn-logout:hover{filter:brightness(1.05)}

    /* Header */
    .content{padding:18px 22px}
    .topbar{display:flex; align-items:center; justify-content:space-between; margin-bottom:14px}
    .search{
      display:flex; align-items:center; gap:10px; background:#0b1431; padding:10px 12px; border-radius:12px; border:1px solid var(--stroke)
    }
    .search input{background:transparent; border:none; outline:none; color:var(--text)}
    .userchip{display:flex; align-items:center; gap:10px; background:var(--grad-soft); padding:10px 12px; border-radius:12px; border:1px solid var(--stroke)}

    /* Grid */
    .grid{display:grid; grid-template-columns: repeat(12, 1fr); gap:var(--gap)}
    .card{background:linear-gradient(180deg, rgba(17,25,58, .9), rgba(11,18,38,.9)); border:1px solid var(--stroke); border-radius:var(--radius); padding:16px; box-shadow:var(--shadow)}
    .card h3{margin:0 0 8px 0; font-size:14px; color:#a8c0ff; letter-spacing:.2px}
    .big{grid-column: span 8}
    .side{grid-column: span 4}
    .full{grid-column: 1 / -1}

    /* KPI cards */
    .kpis{display:grid; grid-template-columns: repeat(4, 1fr); gap:var(--gap); margin-bottom:var(--gap)}
    .kpi{position:relative; overflow:hidden}
    .kpi .val{font-size:28px; font-weight:800}
    .kpi .desc{color:var(--muted)}
    .kpi:before{content:""; position:absolute; inset:auto -10% -50% -10%; height:90px; background:var(--grad); filter:blur(40px); opacity:.35}

    /* Tables */
    table{width:100%; border-collapse:separate; border-spacing:0 8px}
    thead th{font-size:12px; color:#a7b3d6; font-weight:700; text-transform:uppercase; letter-spacing:.5px; text-align:left}
    tbody tr{background:#0c1739; border:1px solid var(--stroke)}
    tbody td{padding:10px 12px}
    tbody tr{border-radius:12px}

    /* Buttons */
    .btn{background:linear-gradient(135deg, rgba(37,99,235,.85), rgba(16,185,129,.85)); color:white; border:none; padding:10px 14px; border-radius:12px; font-weight:700; cursor:pointer}
    .btn-secondary{background:#12214a; border:1px solid var(--stroke)}
    .btn-danger{background:var(--red)}
    .btn-warning{background:var(--yellow); color:#0b1431}
    .btn:disabled{opacity:.5; cursor:not-allowed}

    /* Forms */
    .form{display:grid; grid-template-columns: repeat(12, 1fr); gap:12px}
    .field{grid-column: span 6; display:flex; flex-direction:column; gap:6px}
    .field label{font-size:12px; color:#9fb8ff}
    .field input, .field select, .field textarea{background:#0b1431; border:1px solid var(--stroke); color:var(--text); padding:10px 12px; border-radius:10px}
    .form .actions{grid-column: 1 / -1; display:flex; gap:8px; justify-content:flex-end}

    /* Tabs */
    .tabs{display:flex; gap:8px; margin-bottom:10px}
    .tab{background:#0b1431; border:1px solid var(--stroke); padding:8px 12px; border-radius:10px; cursor:pointer}
    .tab.active{background:var(--grad); color:white}

    /* Modal */
    .modal{position:fixed; inset:0; background:rgba(0,0,0,.6); display:none; align-items:center; justify-content:center; padding:20px; z-index:50}
    .modal.open{display:flex}
    .modal-card{background:#0b1431; border:1px solid var(--stroke); border-radius:16px; width:min(900px, 95vw); box-shadow:var(--shadow)}
    .modal-head{display:flex; align-items:center; justify-content:space-between; padding:12px 14px; border-bottom:1px solid var(--stroke)}
    .modal-body{padding:14px}

    /* Toast */
    .toast{position:fixed; right:20px; bottom:20px; display:flex; flex-direction:column; gap:8px; z-index:60}
    .toast .msg{background:#0b1431; border:1px solid var(--stroke); padding:10px 12px; border-radius:10px; box-shadow:var(--shadow)}

    /* Responsive */
    @media (max-width: 1000px){
      .app{grid-template-columns: 1fr}
      .sidebar{position:static; height:auto}
      .big{grid-column: 1 / -1}
      .side{grid-column: 1 / -1}
      .kpis{grid-template-columns: repeat(2, 1fr)}
      .field{grid-column: span 12}
    }


    .footer {
  background: rgba(0, 0, 0, 0.8);
  color: #f1f1f1;
  padding: 50px 20px 20px;
  margin-top: 50px;
  border-top: 2px solid rgba(255,255,255,0.1);
}

.footer-container {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
  gap: 30px;
  max-width: 1200px;
  margin: auto;
}

.footer-section h2 {
  color: #ffd369;
  margin-bottom: 15px;
  font-size: 1.5rem;
}

.footer-section h3 {
  color: #10b981;
  margin-bottom: 15px;
  font-size: 1.2rem;
}

.footer-section p, 
.footer-section ul li a {
  font-size: 0.95rem;
  color: #ccc;
  text-decoration: none;
}

.footer-section ul {
  list-style: none;
  padding: 0;
}

.footer-section ul li {
  margin-bottom: 8px;
}

.footer-section ul li a:hover {
  color: #ffd369;
}

.footer-section form {
  display: flex;
  margin-top: 10px;
}

.footer-section input[type="email"] {
  padding: 10px;
  border: none;
  border-radius: 20px 0 0 20px;
  outline: none;
  flex: 1;
}

.footer-section button {
  padding: 10px 20px;
  border: none;
  border-radius: 0 20px 20px 0;
  background: linear-gradient(135deg, #ff6a00, #ee0979);
  color: white;
  cursor: pointer;
}

.footer-section button:hover {
  background: linear-gradient(135deg, #ee0979, #ff6a00);
}

.socials {
  margin-top: 15px;
}

.socials a {
  display: inline-block;
  margin-right: 10px;
  font-size: 1.2rem;
  color: #ccc;
  transition: 0.3s;
}

.socials a:hover {
  color: #ffd369;
}

.footer-bottom {
  text-align: center;
  margin-top: 30px;
  border-top: 1px solid rgba(255,255,255,0.2);
  padding-top: 15px;
  font-size: 0.9rem;
  color: #aaa;
}

  </style>
</head>
<body>
  <div class="app">
    <!-- SIDEBAR -->
    <aside class="sidebar">
      <div class="brand">
        <div class="brand-logo">AE</div>
        <div>
          <h1>Amen Estate</h1>
          <small>Admin & Resident Portal</small>
        </div>
      </div>

      <div class="nav" id="nav">
        <button data-route="dashboard" class="active">üìä Dashboard</button>
        <button data-route="estates">üè° Estates</button>
        <button data-route="properties">üè¢ Properties</button>
        <button data-route="units">üß± Units</button>
        <button data-route="tenants">üë• Tenants</button>
        <button data-route="leases">üìù Leases</button>
        <button data-route="billing">üí≥ Billing</button>
        <button data-route="maintenance">üõ†Ô∏è Maintenance</button>
        <button data-route="auth">üîê Auth</button>
      </div>

      <div class="bottom-actions">
        <button class="btn-logout" id="logoutBtn">‚éã Logout</button>
      </div>
    </aside>

    <!-- MAIN CONTENT -->
    <main class="content">
      <div class="topbar">
        <div class="search">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none"><path d="M21 21l-4.35-4.35M10.5 18a7.5 7.5 0 1 1 0-15 7.5 7.5 0 0 1 0 15z" stroke="currentColor" stroke-width="2" opacity=".6"/></svg>
          <input id="globalSearch" placeholder="Search tenants, units, invoices..."/>
        </div>
        <div class="userchip" id="userChip">Guest</div>
      </div>

      <section id="view-dashboard" class="view">
        <div class="kpis">
          <div class="card kpi"><div class="desc">Occupancy</div><div class="val" id="kpi-occupancy">--</div></div>
          <div class="card kpi"><div class="desc">Tenants</div><div class="val" id="kpi-tenants">--</div></div>
          <div class="card kpi"><div class="desc">Pending Invoices</div><div class="val" id="kpi-pending">--</div></div>
          <div class="card kpi"><div class="desc">Revenue (Paid)</div><div class="val" id="kpi-revenue">--</div></div>
        </div>
        <div class="grid">
          <div class="card big">
            <h3>Revenue Trend</h3>
            <canvas id="chartRevenue" height="120"></canvas>
          </div>
          <div class="card side">
            <h3>Quick Actions</h3>
            <div style="display:flex; gap:8px; flex-wrap:wrap">
              <button class="btn" onclick="openModal('createTenantModal')">+ New Tenant</button>
              <button class="btn" onclick="openModal('createLeaseModal')">+ New Lease</button>
              <button class="btn" onclick="openModal('createInvoiceModal')">+ Generate Invoices</button>
              <button class="btn" onclick="openModal('ticketModal')">+ Maintenance Ticket</button>
            </div>
          </div>
          <div class="card full">
            <h3>Recent Invoices</h3>
            <table>
              <thead><tr><th>Ref</th><th>Lease</th><th>Due</th><th>Amount</th><th>Status</th><th></th></tr></thead>
              <tbody id="recentInvoices"></tbody>
            </table>
          </div>
        </div>
      </section>

      <section id="view-estates" class="view" style="display:none">
        <div class="tabs">
          <div class="tab active" data-tab="list-estates">List</div>
          <div class="tab" data-tab="create-estate">Create</div>
        </div>
        <div id="tab-list-estates" class="card">
          <table>
            <thead><tr><th>ID</th><th>Name</th><th>Location</th></tr></thead>
            <tbody id="tbl-estates"></tbody>
          </table>
        </div>
        <div id="tab-create-estate" class="card" style="display:none">
          <form id="form-estate" class="form">
            <div class="field"><label>Name</label><input name="name" required></div>
            <div class="field"><label>Location</label><input name="location" required></div>
            <div class="actions"><button class="btn" type="submit">Create Estate</button></div>
          </form>
        </div>
      </section>

      <section id="view-properties" class="view" style="display:none">
        <div class="tabs">
          <div class="tab active" data-tab="list-properties">List</div>
          <div class="tab" data-tab="create-property">Create</div>
        </div>
        <div id="tab-list-properties" class="card">
          <table>
            <thead><tr><th>ID</th><th>Code</th><th>Address</th><th>Estate ID</th></tr></thead>
            <tbody id="tbl-properties"></tbody>
          </table>
        </div>
        <div id="tab-create-property" class="card" style="display:none">
          <form id="form-property" class="form">
            <div class="field"><label>Code</label><input name="code" required></div>
            <div class="field"><label>Address</label><input name="address" required></div>
            <div class="field"><label>Estate ID</label><input name="estate_id" type="number" required></div>
            <div class="actions"><button class="btn" type="submit">Create Property</button></div>
          </form>
        </div>
      </section>

      <section id="view-units" class="view" style="display:none">
        <div class="tabs">
          <div class="tab active" data-tab="list-units">List</div>
          <div class="tab" data-tab="create-unit">Create</div>
        </div>
        <div id="tab-list-units" class="card">
          <table>
            <thead><tr><th>ID</th><th>Property</th><th>Label</th><th>Bedrooms</th><th>Occupied</th></tr></thead>
            <tbody id="tbl-units"></tbody>
          </table>
        </div>
        <div id="tab-create-unit" class="card" style="display:none">
          <form id="form-unit" class="form">
            <div class="field"><label>Property ID</label><input name="property_id" type="number" required></div>
            <div class="field"><label>Label</label><input name="label" required></div>
            <div class="field"><label>Bedrooms</label><input name="bedrooms" type="number" value="2" required></div>
            <div class="actions"><button class="btn" type="submit">Create Unit</button></div>
          </form>
        </div>
      </section>

      <section id="view-tenants" class="view" style="display:none">
        <div class="tabs">
          <div class="tab active" data-tab="list-tenants">List</div>
          <div class="tab" data-tab="create-tenant">Create</div>
        </div>
        <div id="tab-list-tenants" class="card">
          <table>
            <thead><tr><th>ID</th><th>Name</th><th>Email</th><th>Phone</th></tr></thead>
            <tbody id="tbl-tenants"></tbody>
          </table>
        </div>
        <div id="tab-create-tenant" class="card" style="display:none">
          <form id="form-tenant" class="form">
            <div class="field"><label>Full Name</label><input name="full_name" required></div>
            <div class="field"><label>Email</label><input name="email" type="email" required></div>
            <div class="field"><label>Phone</label><input name="phone"></div>
            <div class="actions"><button class="btn" type="submit">Create Tenant</button></div>
          </form>
        </div>
      </section>

      <section id="view-leases" class="view" style="display:none">
        <div class="tabs">
          <div class="tab active" data-tab="list-leases">List</div>
          <div class="tab" data-tab="create-lease">Create</div>
        </div>
        <div id="tab-list-leases" class="card">
          <table>
            <thead><tr><th>ID</th><th>Unit</th><th>Tenant</th><th>Start</th><th>End</th><th>Rent</th><th>Freq (mo)</th><th>Active</th><th>Invoices</th></tr></thead>
            <tbody id="tbl-leases"></tbody>
          </table>
        </div>
        <div id="tab-create-lease" class="card" style="display:none">
          <form id="form-lease" class="form">
            <div class="field"><label>Unit ID</label><input name="unit_id" type="number" required></div>
            <div class="field"><label>Tenant ID</label><input name="tenant_id" type="number" required></div>
            <div class="field"><label>Start Date</label><input name="start_date" type="date" required></div>
            <div class="field"><label>End Date</label><input name="end_date" type="date" required></div>
            <div class="field"><label>Rent Amount</label><input name="rent_amount" type="number" step="0.01" required></div>
            <div class="field"><label>Frequency (months)</label><input name="frequency_months" type="number" value="12" required></div>
            <div class="actions"><button class="btn" type="submit">Create Lease</button></div>
          </form>
        </div>
      </section>

      <section id="view-billing" class="view" style="display:none">
        <div class="tabs">
          <div class="tab active" data-tab="list-invoices">Invoices</div>
          <div class="tab" data-tab="create-payment">Record Payment</div>
        </div>
        <div id="tab-list-invoices" class="card">
          <div style="display:flex; gap:8px; margin-bottom:10px">
            <select id="filter-invoice-status">
              <option value="">All Status</option>
              <option value="pending">Pending</option>
              <option value="paid">Paid</option>
              <option value="overdue">Overdue</option>
            </select>
            <button class="btn" onclick="loadInvoices()">Apply</button>
          </div>
          <table>
            <thead><tr><th>ID</th><th>Lease</th><th>Due</th><th>Amount</th><th>Status</th><th>Ref</th></tr></thead>
            <tbody id="tbl-invoices"></tbody>
          </table>
        </div>
        <div id="tab-create-payment" class="card" style="display:none">
          <form id="form-payment" class="form">
            <div class="field"><label>Invoice ID</label><input name="invoice_id" type="number" required></div>
            <div class="field"><label>Amount</label><input name="amount" type="number" step="0.01" required></div>
            <div class="field"><label>Transaction Ref</label><input name="txn_ref" required></div>
            <div class="actions"><button class="btn" type="submit">Record Payment</button></div>
          </form>
        </div>
      </section>

      <section id="view-maintenance" class="view" style="display:none">
        <div class="tabs">
          <div class="tab active" data-tab="list-tickets">Tickets</div>
          <div class="tab" data-tab="create-ticket">Create</div>
        </div>
        <div id="tab-list-tickets" class="card">
          <table>
            <thead><tr><th>ID</th><th>Unit</th><th>Title</th><th>Priority</th><th>Status</th><th></th></tr></thead>
            <tbody id="tbl-tickets"></tbody>
          </table>
        </div>
        <div id="tab-create-ticket" class="card" style="display:none">
          <form id="form-ticket" class="form">
            <div class="field"><label>Unit ID</label><input name="unit_id" type="number" required></div>
            <div class="field"><label>Title</label><input name="title" required></div>
            <div class="field" style="grid-column: span 12"><label>Description</label><textarea name="description" rows="4"></textarea></div>
            <div class="field"><label>Priority</label>
              <select name="priority">
                <option value="low">Low</option>
                <option value="medium" selected>Medium</option>
                <option value="high">High</option>
              </select></div>
            <div class="actions"><button class="btn" type="submit">Create Ticket</button></div>
          </form>
        </div>
      </section>

      <section id="view-auth" class="view" style="display:none">
        <div class="grid">
          <div class="card big">
            <h3>Login</h3>
            <form id="form-login" class="form">
              <div class="field"><label>Email</label><input type="email" name="email" required></div>
              <div class="field"><label>Password</label><input type="password" name="password" required></div>
              <div class="actions"><button class="btn" type="submit">Sign In</button></div>
            </form>
          </div>
          <div class="card side">
            <h3>Register Admin</h3>
            <form id="form-register" class="form">
              <div class="field"><label>Full Name</label><input name="full_name" required></div>
              <div class="field"><label>Email</label><input type="email" name="email" required></div>
              <div class="field"><label>Password</label><input type="password" name="password" required></div>
              <div class="actions"><button class="btn-warning btn" type="submit">Create Admin</button></div>
            </form>
          </div>
        </div>
      </section>
    </main>
  </div>

  <!-- MODALS -->
  <div class="modal" id="createTenantModal">
    <div class="modal-card">
      <div class="modal-head"><strong>New Tenant</strong><button class="btn-secondary" onclick="closeModal('createTenantModal')">‚úï</button></div>
      <div class="modal-body">
        <form id="modal-form-tenant" class="form">
          <div class="field"><label>Full Name</label><input name="full_name" required></div>
          <div class="field"><label>Email</label><input type="email" name="email" required></div>
          <div class="field"><label>Phone</label><input name="phone"></div>
          <div class="actions"><button class="btn" type="submit">Create Tenant</button></div>
        </form>
      </div>
    </div>
  </div>

  <div class="modal" id="createLeaseModal">
    <div class="modal-card">
      <div class="modal-head"><strong>New Lease</strong><button class="btn-secondary" onclick="closeModal('createLeaseModal')">‚úï</button></div>
      <div class="modal-body">
        <form id="modal-form-lease" class="form">
          <div class="field"><label>Unit ID</label><input name="unit_id" type="number" required></div>
          <div class="field"><label>Tenant ID</label><input name="tenant_id" type="number" required></div>
          <div class="field"><label>Start Date</label><input name="start_date" type="date" required></div>
          <div class="field"><label>End Date</label><input name="end_date" type="date" required></div>
          <div class="field"><label>Rent Amount</label><input name="rent_amount" type="number" step="0.01" required></div>
          <div class="field"><label>Frequency (months)</label><input name="frequency_months" type="number" value="12" required></div>
          <div class="actions"><button class="btn" type="submit">Create Lease</button></div>
        </form>
      </div>
    </div>
  </div>

  <div class="modal" id="createInvoiceModal">
    <div class="modal-card">
      <div class="modal-head"><strong>Generate Invoices for Lease</strong><button class="btn-secondary" onclick="closeModal('createInvoiceModal')">‚úï</button></div>
      <div class="modal-body">
        <form id="modal-form-invoice-gen" class="form">
          <div class="field"><label>Lease ID</label><input name="lease_id" type="number" required></div>
          <div class="actions"><button class="btn" type="submit">Generate</button></div>
        </form>
      </div>
    </div>
  </div>

  <div class="modal" id="ticketModal">
    <div class="modal-card">
      <div class="modal-head"><strong>Create Maintenance Ticket</strong><button class="btn-secondary" onclick="closeModal('ticketModal')">‚úï</button></div>
      <div class="modal-body">
        <form id="modal-form-ticket" class="form">
          <div class="field"><label>Unit ID</label><input name="unit_id" type="number" required></div>
          <div class="field"><label>Title</label><input name="title" required></div>
          <div class="field" style="grid-column: span 12"><label>Description</label><textarea name="description" rows="4"></textarea></div>
          <div class="field"><label>Priority</label>
            <select name="priority"><option>low</option><option selected>medium</option><option>high</option></select></div>
          <div class="actions"><button class="btn" type="submit">Create Ticket</button></div>
        </form>
      </div>
    </div>
  </div>
  

  <div class="toast" id="toast"></div>

  <!-- ================== FOOTER ================== -->
<footer class="footer">
  <div class="footer-container">
    <!-- About -->
    <div class="footer-section">
      <h2>üè¢ Amen Estate</h2>
      <p>Amen Estate is your trusted platform for managing properties, tenants, and finances with ease. Bringing simplicity and automation to real estate.</p>
    </div>

    <!-- Quick Links -->
    <div class="footer-section">
      <h3>Quick Links</h3>
      <ul>
        <li><a href="#">Dashboard</a></li>
        <li><a href="#">Properties</a></li>
        <li><a href="#">Tenants</a></li>
        <li><a href="#">Finances</a></li>
        <li><a href="#">Support</a></li>
      </ul>
    </div>

    <!-- Contact -->
    <div class="footer-section">
      <h3>Contact</h3>
      <p>Email: adelerekehinde01@gmail.com</p>
      <p>Phone: +234 90 525 1091 0</p>
      <p>Location: Lagos, Nigeria</p>
    </div>

    <!-- Newsletter -->
    <div class="footer-section newsletter">
      <h3>Stay Updated</h3>
      <form>
        <input type="email" placeholder="Enter your email" required>
        <button type="submit">Subscribe</button>
      </form>
      <div class="socials">
        <a href="facebook.com"><i class="fab fa-facebook-f"></i></a>
        <a href="x.com"><i class="fab fa-twitter"></i></a>
        <a href="linkedin.com"><i class="fab fa-linkedin-in"></i></a>
        <a href="instagram.com"><i class="fab fa-instagram"></i></a>
      </div>
    </div>
  </div>

  <div class="footer-bottom">
    <p>¬© 2025 Amen Estate. All Rights Reserved.</p>
  </div>
</footer>


  <script>
    // ================= CONFIG =================
    const API_BASE = localStorage.getItem('API_BASE') || 'http://localhost:8000';

    // ================= UTILITIES =================
    const $ = (sel, root=document) => root.querySelector(sel);
    const $$ = (sel, root=document) => Array.from(root.querySelectorAll(sel));

    function toast(msg, type='info'){ // type: info | error | success
      const t = document.createElement('div');
      t.className = 'msg';
      t.style.borderColor = type==='error'? 'var(--red)' : type==='success'? 'var(--green)' : 'var(--stroke)';
      t.textContent = msg;
      $('#toast').appendChild(t);
      setTimeout(()=> t.remove(), 3500);
    }

    function openModal(id){ $('#'+id).classList.add('open'); }
    function closeModal(id){ $('#'+id).classList.remove('open'); }

    function serializeForm(form){
      const data = new FormData(form); const obj={};
      for(const [k,v] of data.entries()) obj[k] = v;
      // cast numbers if numeric inputs
      $$('input[type="number"]', form).forEach(inp=>{ const k=inp.name; if(obj[k]!==undefined) obj[k]=Number(obj[k]); });
      return obj;
    }

    function setAuthUser(user){
      if(user){ $('#userChip').textContent = `${user.full_name || 'User'} ¬∑ ${user.role || ''}`; }
      else{ $('#userChip').textContent = 'Guest'; }
    }

    function authHeader(){
      const token = localStorage.getItem('token');
      return token ? { 'Authorization': 'Bearer ' + token } : {};
    }

    async function apiFetch(path, options={}){
      const headers = Object.assign({ 'Content-Type': 'application/json' }, authHeader(), options.headers||{});
      const res = await fetch(API_BASE + path, Object.assign({}, options, { headers }));
      if(!res.ok){
        const text = await res.text().catch(()=> '');
        throw new Error(`HTTP ${res.status}: ${text || res.statusText}`);
      }
      const ct = res.headers.get('content-type') || '';
      return ct.includes('application/json') ? res.json() : res.text();
    }

    // ================ ROUTING (simple SPA) ================
    const routes = ['dashboard','estates','properties','units','tenants','leases','billing','maintenance','auth'];
    function show(route){
      routes.forEach(r=>{
        const v = $('#view-'+r);
        if(v) v.style.display = r===route ? '' : 'none';
      });
      $$('#nav button').forEach(b=> b.classList.toggle('active', b.dataset.route===route));
      localStorage.setItem('route', route);
      if(route!=='auth'){ loadAllFor(route); }
    }

    // ================ LOADERS / DASHBOARD ================
    async function loadDashboard(){
      try{
        const [units, tenants, invoices] = await Promise.all([
          apiFetch('/units'), apiFetch('/tenants'), apiFetch('/invoices?status='),
        ]);
        const occupied = units.filter(u=>u.occupied).length;
        const occupancy = units.length ? Math.round((occupied/units.length)*100) : 0;
        $('#kpi-occupancy').textContent = occupancy + '%';
        $('#kpi-tenants').textContent = tenants.length;
        const pending = invoices.filter(i=>i.status==='pending').length;
        $('#kpi-pending').textContent = pending;
        const paidTotal = invoices.filter(i=>i.status==='paid').reduce((s,i)=> s + (i.amount || 0), 0);
        $('#kpi-revenue').textContent = paidTotal.toLocaleString();
        drawRevenueChart(invoices.filter(i=>i.status==='paid'));
        renderRecentInvoices(invoices.slice(-8).reverse());
      }catch(e){ toast(e.message,'error'); }
    }

    function drawRevenueChart(paid){
      const canvas = $('#chartRevenue');
      const ctx = canvas.getContext('2d');
      ctx.clearRect(0,0,canvas.width, canvas.height);
      // group by month
      const byMonth = {};
      for(const inv of paid){
        const d = new Date(inv.due_date);
        const k = d.getFullYear()+ '-' + String(d.getMonth()+1).padStart(2,'0');
        byMonth[k] = (byMonth[k]||0) + inv.amount;
      }
      const labels = Object.keys(byMonth).sort();
      const values = labels.map(k=>byMonth[k]);
      // axes
      const w = canvas.width = canvas.clientWidth; const h = canvas.height = 160;
      const pad = 30; const max = Math.max(...values, 100);
      ctx.strokeStyle = '#223'; ctx.lineWidth = 1;
      ctx.beginPath(); ctx.moveTo(pad, h-pad); ctx.lineTo(w-pad, h-pad); ctx.stroke();
      ctx.beginPath(); ctx.moveTo(pad, h-pad); ctx.lineTo(pad, pad/2); ctx.stroke();
      // line
      ctx.beginPath();
      values.forEach((v,i)=>{
        const x = pad + (i*(w-2*pad))/Math.max(values.length-1,1);
        const y = h-pad - (v/max)*(h-2*pad);
        if(i===0) ctx.moveTo(x,y); else ctx.lineTo(x,y);
      });
      ctx.strokeStyle = '#6ee7b7'; ctx.lineWidth = 2; ctx.stroke();
      // gradient fill
      const g = ctx.createLinearGradient(0,pad,0,h-pad);
      g.addColorStop(0,'rgba(16,185,129,.35)'); g.addColorStop(1,'rgba(16,185,129,0)');
      ctx.fillStyle = g; ctx.lineTo(w-pad,h-pad); ctx.lineTo(pad,h-pad); ctx.closePath(); ctx.fill();
      // labels
      ctx.fillStyle = '#9fb8ff'; ctx.font = '10px sans-serif';
      labels.forEach((lab,i)=>{
        const x = pad + (i*(w-2*pad))/Math.max(values.length-1,1);
        ctx.fillText(lab, x-14, h-10);
      });
    }

    function renderRecentInvoices(list){
      const tbody = $('#recentInvoices'); tbody.innerHTML='';
      list.forEach(i=>{
        const tr = document.createElement('tr');
        tr.innerHTML = `<td>${i.ref||'-'}</td><td>${i.lease_id}</td><td>${i.due_date}</td><td>${i.amount.toLocaleString()}</td><td>${i.status}</td>
        <td><button class="btn-secondary" onclick="prefillPayment(${i.id}, ${i.amount})">Pay</button></td>`;
        tbody.appendChild(tr);
      })
    }

    // ================ ENTITY LOADERS ================
    async function loadEstates(){
      try{ const data = await apiFetch('/estates');
        const tbody = $('#tbl-estates'); tbody.innerHTML='';
        data.forEach(e=>{ const tr=document.createElement('tr'); tr.innerHTML=`<td>${e.id}</td><td>${e.name}</td><td>${e.location}</td>`; tbody.appendChild(tr); });
      }catch(e){ toast(e.message,'error'); }
    }

    async function loadProperties(){
      try{ const data = await apiFetch('/properties');
        const tbody = $('#tbl-properties'); tbody.innerHTML='';
        data.forEach(p=>{ const tr=document.createElement('tr'); tr.innerHTML=`<td>${p.id}</td><td>${p.code}</td><td>${p.address}</td><td>${p.estate_id}</td>`; tbody.appendChild(tr); });
      }catch(e){ toast(e.message,'error'); }
    }

    async function loadUnits(){
      try{ const data = await apiFetch('/units');
        const tbody = $('#tbl-units'); tbody.innerHTML='';
        data.forEach(u=>{ const tr=document.createElement('tr'); tr.innerHTML=`<td>${u.id}</td><td>${u.property_id}</td><td>${u.label}</td><td>${u.bedrooms}</td><td>${u.occupied? 'Yes':'No'}</td>`; tbody.appendChild(tr); });
      }catch(e){ toast(e.message,'error'); }
    }

    async function loadTenants(){
      try{ const data = await apiFetch('/tenants');
        const tbody = $('#tbl-tenants'); tbody.innerHTML='';
        data.forEach(t=>{ const tr=document.createElement('tr'); tr.innerHTML=`<td>${t.id}</td><td>${t.full_name}</td><td>${t.email}</td><td>${t.phone||''}</td>`; tbody.appendChild(tr); });
      }catch(e){ toast(e.message,'error'); }
    }

    async function loadLeases(){
      try{ const data = await apiFetch('/leases'); // not implemented list endpoint in API; fallback to invoices join based views
      }catch{ /* ignore */ }
      try{ const invoices = await apiFetch('/invoices');
        const byLease = {};
        invoices.forEach(i=>{ if(!byLease[i.lease_id]) byLease[i.lease_id]=[]; byLease[i.lease_id].push(i); });
        const tbody = $('#tbl-leases'); tbody.innerHTML='';
        Object.keys(byLease).forEach(id=>{
          const arr = byLease[id]; const inv = arr[0];
          const tr = document.createElement('tr');
          tr.innerHTML = `<td>${id}</td><td>${inv ? inv.lease_id : '-'}</td><td>-</td><td>${inv ? inv.due_date : '-'}</td><td>-</td><td>${inv ? inv.amount.toLocaleString() : '-'}</td><td>-</td><td>-</td>
          <td><button class="btn" onclick="openModal('createInvoiceModal'); $('#modal-form-invoice-gen [name=\'lease_id\']').value=${id};">Generate</button></td>`;
          tbody.appendChild(tr);
        });
      }catch(e){ toast(e.message,'error'); }
    }

    async function loadInvoices(){
      try{
        const status = $('#filter-invoice-status').value;
        const path = status? `/invoices?status=${encodeURIComponent(status)}` : '/invoices';
        const data = await apiFetch(path);
        const tbody = $('#tbl-invoices'); tbody.innerHTML='';
        data.forEach(i=>{ const tr=document.createElement('tr'); tr.innerHTML=`<td>${i.id}</td><td>${i.lease_id}</td><td>${i.due_date}</td><td>${i.amount.toLocaleString()}</td><td>${i.status}</td><td>${i.ref||''}</td>`; tbody.appendChild(tr); });
      }catch(e){ toast(e.message,'error'); }
    }

    async function loadTickets(){
      try{ const data = await apiFetch('/maintenance/tickets'); /* list not in API; we will show only created ones via cache */ }
      catch{ /* ignore */ }
    }

    async function loadAllFor(route){
      if(!localStorage.getItem('token')){ show('auth'); return; }
      setAuthUser(JSON.parse(localStorage.getItem('user')||'{}'));
      switch(route){
        case 'dashboard': await loadDashboard(); break;
        case 'estates': await loadEstates(); break;
        case 'properties': await loadProperties(); break;
        case 'units': await loadUnits(); break;
        case 'tenants': await loadTenants(); break;
        case 'leases': await loadLeases(); break;
        case 'billing': await loadInvoices(); break;
        case 'maintenance': await loadTickets(); break;
      }
    }

    // ================ FORMS HANDLERS ================
    $('#form-estate').addEventListener('submit', async (e)=>{
      e.preventDefault(); try{ const body = serializeForm(e.target); await apiFetch('/estates',{method:'POST', body: JSON.stringify(body)}); toast('Estate created','success'); loadEstates(); show('estates'); }catch(err){ toast(err.message,'error'); }
    });

    $('#form-property').addEventListener('submit', async (e)=>{
      e.preventDefault(); try{ const body=serializeForm(e.target); await apiFetch('/properties',{method:'POST', body: JSON.stringify(body)}); toast('Property created','success'); loadProperties(); }catch(err){ toast(err.message,'error'); }
    });

    $('#form-unit').addEventListener('submit', async (e)=>{
      e.preventDefault(); try{ const body=serializeForm(e.target); await apiFetch('/units',{method:'POST', body: JSON.stringify(body)}); toast('Unit created','success'); loadUnits(); }catch(err){ toast(err.message,'error'); }
    });

    $('#form-tenant').addEventListener('submit', async (e)=>{
      e.preventDefault(); try{ const body=serializeForm(e.target); await apiFetch('/tenants',{method:'POST', body: JSON.stringify(body)}); toast('Tenant created','success'); loadTenants(); }catch(err){ toast(err.message,'error'); }
    });

    $('#modal-form-tenant').addEventListener('submit', async (e)=>{
      e.preventDefault(); try{ const body=serializeForm(e.target); await apiFetch('/tenants',{method:'POST', body: JSON.stringify(body)}); toast('Tenant created','success'); closeModal('createTenantModal'); loadTenants(); }catch(err){ toast(err.message,'error'); }
    });

    $('#form-lease').addEventListener('submit', async (e)=>{
      e.preventDefault(); try{ const body=serializeForm(e.target); await apiFetch('/leases',{method:'POST', body: JSON.stringify(body)}); toast('Lease created','success'); loadLeases(); }catch(err){ toast(err.message,'error'); }
    });

    $('#modal-form-lease').addEventListener('submit', async (e)=>{
      e.preventDefault(); try{ const body=serializeForm(e.target); await apiFetch('/leases',{method:'POST', body: JSON.stringify(body)}); toast('Lease created','success'); closeModal('createLeaseModal'); loadLeases(); }catch(err){ toast(err.message,'error'); }
    });

    $('#modal-form-invoice-gen').addEventListener('submit', async (e)=>{
      e.preventDefault(); try{ const body=serializeForm(e.target); await apiFetch(`/leases/${body.lease_id}/generate-invoices`,{method:'POST'}); toast('Invoices generated','success'); closeModal('createInvoiceModal'); loadInvoices(); }catch(err){ toast(err.message,'error'); }
    });

    $('#form-payment').addEventListener('submit', async (e)=>{
      e.preventDefault(); try{ const body=serializeForm(e.target); await apiFetch('/payments',{method:'POST', body: JSON.stringify(body)}); toast('Payment recorded','success'); loadInvoices(); }catch(err){ toast(err.message,'error'); }
    });

    $('#form-ticket').addEventListener('submit', async (e)=>{
      e.preventDefault(); try{ const body=serializeForm(e.target); await apiFetch('/maintenance/tickets',{method:'POST', body: JSON.stringify(body)}); toast('Ticket created','success'); loadTickets(); }catch(err){ toast(err.message,'error'); }
    });

    $('#modal-form-ticket').addEventListener('submit', async (e)=>{
      e.preventDefault(); try{ const body=serializeForm(e.target); await apiFetch('/maintenance/tickets',{method:'POST', body: JSON.stringify(body)}); toast('Ticket created','success'); closeModal('ticketModal'); loadTickets(); }catch(err){ toast(err.message,'error'); }
    });

    function prefillPayment(invoiceId, amount){
      const form = $('#form-payment');
      form.invoice_id.value = invoiceId; form.amount.value = amount; show('billing');
    }

    // ================ AUTH ================
    $('#form-register').addEventListener('submit', async (e)=>{
      e.preventDefault();
      try{
        const body = serializeForm(e.target); body.role = 'admin';
        const res = await apiFetch('/auth/register',{method:'POST', body: JSON.stringify(body)});
        localStorage.setItem('token', res.access_token);
        localStorage.setItem('user', JSON.stringify({full_name: body.full_name, role:'admin'}));
        toast('Admin registered & logged in','success'); setAuthUser(JSON.parse(localStorage.getItem('user'))); show('dashboard');
      }catch(err){ toast(err.message,'error'); }
    });

    $('#form-login').addEventListener('submit', async (e)=>{
      e.preventDefault();
      try{
        const body = serializeForm(e.target);
        const res = await apiFetch('/auth/login',{method:'POST', body: JSON.stringify(body)});
        localStorage.setItem('token', res.access_token);
        // We don't have a /me endpoint; store the email as display
        localStorage.setItem('user', JSON.stringify({full_name: body.email.split('@')[0], role:'admin'}));
        toast('Logged in','success'); setAuthUser(JSON.parse(localStorage.getItem('user'))); show('dashboard');
      }catch(err){ toast(err.message,'error'); }
    });

    $('#logoutBtn').addEventListener('click', ()=>{
      localStorage.removeItem('token'); localStorage.removeItem('user'); toast('Logged out','success'); show('auth'); setAuthUser(null);
    });

    // ================ NAV / TABS ================
    $$('#nav button').forEach(btn=> btn.addEventListener('click', ()=> show(btn.dataset.route)));

    function initTabs(){
      $$('.tabs').forEach(tabs=>{
        const tabBtns = $$('.tab', tabs);
        tabBtns.forEach(b=> b.addEventListener('click', ()=>{
          tabBtns.forEach(x=> x.classList.toggle('active', x===b));
          const section = tabs.parentElement; // section/view
          $$('#'+section.id+' > [id^=tab-]').forEach(panel=> panel.style.display='none');
          $('#'+ 'tab-' + b.dataset.tab).style.display='';
        }))
      })
    }

    // ================ SEARCH (client side demo) ================
    $('#globalSearch').addEventListener('keydown', (e)=>{
      if(e.key==='Enter') toast('Global search is a UI demo. Use module lists/filters to find records.');
    });

    // ================ STARTUP ================
    (function(){
      initTabs();
      const route = localStorage.getItem('route') || 'dashboard';
      if(!localStorage.getItem('token')){ show('auth'); } else { show(route); }
    })();
    
  </script>
</body>
</html>
